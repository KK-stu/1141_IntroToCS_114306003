<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>
	<style>
		body {
			font-family: Critter, cursive, sans-serif;
			text-align: center;
			padding-top: 20px;
		}
		#gameContainer {
			width: 350px;
			margin: 0 auto;
			border: 1px solid #ccc;
			padding: 20px;
			border-radius: 8px;
		}
		input[type="text"] {
			padding: 8px;
			margin-right: 10px;
			width: 150px;
			text-align: center;
		}
		button {
			padding: 8px 15px;
			cursor: pointer;
		}
		textarea {
			width: 100%;
			height: 200px;
			margin-top: 15px;
			padding: 10px;
			box-sizing: border-box;
			font-family: monospace;
		}
		#statusMessage {
			margin-top: 10px;
			font-weight: bold;
			min-height: 20px;
		}
		#gameRecord{
			text-align: left;
		}
	</style>
</head>

<body>
	<h1>114306003_HW7_1A2B</h1>

	<div id="gameContainer">
		<p>Enter 4 unique numbers  (0-9):</p>
		<input type="text" id="guessInput" maxlength="4">
		<button id="guessButton" onclick="play()">Guess!</button>

		<h3>Game Record:</h3>
		<textarea id="gameRecord" readonly></textarea>

		<div id="statusMessage"></div>
	</div>

	<script>
		// å…¨åŸŸè®Šæ•¸ï¼Œç”¨æ–¼å„²å­˜ç­”æ¡ˆå’ŒçŒœæ¸¬æ¬¡æ•¸
		var answer;
		var guessCount = 0;

		// -----------------------------------------------------------
		// key1: ç”Ÿæˆç­”æ¡ˆ (4å€‹ä¸é‡è¤‡çš„æ•¸å­—)
		// éš¨æ©Ÿé¸æ“‡ä¸€å€‹æ•¸å­—ä¸¦å¾é™£åˆ—ä¸­ç§»é™¤ï¼Œç¢ºä¿ä¸é‡è¤‡
		// å°‡æ•¸å­—åŠ å…¥ç­”æ¡ˆå­—ä¸²å¾Œç§»é™¤
		function generateAnswer() {
			var digits = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
			var ans = "";

			for (var i = 0; i < 4; i++) {
				var randomIndex = Math.floor(Math.random() * digits.length);
				var digit = digits[randomIndex];
				ans += digit; 
				digits.splice(randomIndex, 1); 
			}
			return ans;
		}

		// -----------------------------------------------------------
		// key2: é©—è­‰ç©å®¶è¼¸å…¥
		// å¿…é ˆ: é•·åº¦ç‚º4ã€ å¿…é ˆç‚ºæ•¸å­—ã€ æ•¸å­—ä¸é‡è¤‡
		function isValid(str) {
			if (str.length !== 4) {
				alert("ç„¡æ•ˆè¼¸å…¥ï¼\nè«‹è¼¸å…¥ ã€ 4 å€‹ã€‘ æ•¸å­—");
				return false;
			}

			if (!/^\d{4}$/.test(str)) {
				alert("ç„¡æ•ˆè¼¸å…¥ï¼\nè«‹è¼¸å…¥ ã€æ•¸å­—ã€‘");
				return false;
			}

			var uniqueDigits = {};
			for (var i = 0; i < str.length; i++) {
				var char = str[i];
				if (uniqueDigits.hasOwnProperty(char)) {
					alert("ç„¡æ•ˆè¼¸å…¥ï¼\nè«‹è¼¸å…¥4å€‹ ã€ä¸é‡è¤‡ã€‘ çš„æ•¸å­—");
					return false;
				}
				uniqueDigits[char] = true;
			}

			return true;
		}

		// -----------------------------------------------------------
		// key3: è¨ˆç®— A å’Œ B
		function checkAB(guess, ans) {
			var A = 0;
			var B = 0;

			for (var i = 0; i < 4; i++) {
				if (guess[i] === ans[i]) {
					A++;
				} else if (ans.indexOf(guess[i]) !== -1) {
					B++;
				}
			}
			return A + "A" + B + "B";
		}

		// -----------------------------------------------------------
		// key4: éŠæˆ²ä¸»æµç¨‹ (é»æ“ŠåŸ·è¡Œ)
		function play() {
			var inputElement = document.getElementById('guessInput');
			var guess = inputElement.value.trim(); // ç²å–è¼¸å…¥ä¸¦ç§»é™¤ç©ºç™½
			var recordElement = document.getElementById('gameRecord');
			var statusElement = document.getElementById('statusMessage');

			// 1. é©—è­‰è¼¸å…¥
			if (!isValid(guess)) {
				inputElement.value = "";
				inputElement.focus();
				return;
			}

			// 2. æ›´æ–°çŒœæ¸¬æ¬¡æ•¸
			guessCount++;

			// 3. è¨ˆç®— A/B
			var result = checkAB(guess, answer);

			// 4. æ›´æ–°è¨˜éŒ„å€
			var recordEntry = "ç¬¬" + guessCount + "æ¬¡: " + guess + " â†’ " + result + "\n";
			recordElement.value += recordEntry; 

			// 5. æ¸…é™¤è¼¸å…¥æ¡†
			inputElement.value = "";
			inputElement.focus(); // è®“è¼¸å…¥æ¡†ä¿æŒç„¦é»ï¼Œæ–¹ä¾¿ä¸‹ä¸€æ¬¡è¼¸å…¥

			// 6. æª¢æŸ¥æ˜¯å¦çŒœä¸­ (4A0B)
			if (result === "4A0B") {
				alert("ğŸ‰ æ­å–œä½ ï¼åœ¨ç¬¬ " + guessCount + " æ¬¡çŒœä¸­äº†ï¼æ­£ç¢ºç­”æ¡ˆæ˜¯ " + answer);

				// ç¦ç”¨è¼¸å…¥å’ŒæŒ‰éˆ•ï¼ŒçµæŸéŠæˆ²
				document.getElementById('guessButton').disabled = true;
				inputElement.disabled = true;
			}
		}

		// -----------------------------------------------------------
		// key5: éŠæˆ²åˆå§‹åŒ–
		answer = generateAnswer();

	</script>

</body>
</html>